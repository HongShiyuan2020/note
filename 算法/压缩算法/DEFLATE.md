
**DEFLATE** 是一种结合了 **LZ77 算法** 和 **哈夫曼编码（Huffman Coding）** 的无损数据压缩算法，广泛应用于 ZIP、GZIP、PNG 等格式。它的核心思想是：

1. **用 LZ77 消除重复数据**（滑动窗口匹配重复字符串）。
2. **用哈夫曼编码进一步压缩**（对符号进行变长编码，高频符号用更短的码字）。

---

## **DEFLATE 算法详细步骤**

### **1. LZ77 压缩阶段（重复字符串消除）**

LZ77 通过滑动窗口（通常 32KB）查找并替换重复字符串，输出 `<长度, 距离, 下一个字符>` 三元组：

- **长度（Length）**：匹配的字符串长度（3~258 字节）。
- **距离（Distance）**：匹配字符串相对于当前位置的偏移（1~32768 字节）。
- **下一个字符（Literal）**：如果无匹配，直接输出原始字符。

**示例**：  
输入字符串：`"ABRACADABRABRABRA"`  
LZ77 可能输出：

- `A`（无匹配，直接输出）
- `B`
- `R`
- `A`
- `C`
- `A`
- `D`
- `<长度=7, 距离=8>`（匹配 "ABRABRA"）

此时数据变为 **Literal 字符 + 匹配对（Length/Distance）** 的混合序列。

---

### **2. 哈夫曼编码阶段（进一步压缩）**

DEFLATE 使用 **两种哈夫曼树** 分别压缩：

1. **Literal/Length 树**：编码 Literal 字符（0~255）和 Length 值（257~285）。
    
2. **Distance 树**：编码 Distance 值（0~29，实际距离通过查表映射）。
    

#### **（1）构建哈夫曼树**

- 统计 Literal/Length 和 Distance 的出现频率。
    
- 根据频率生成最优前缀码（高频符号用短码，低频用长码）。
    

**示例**：  
假设某数据中：

- `'A'` 出现 10 次 → 分配短码（如 `01`）。
    
- `'X'` 出现 1 次 → 分配长码（如 `11010`）。
    

#### **（2）编码数据**

- 将 LZ77 输出的 Literals、Lengths、Distances 用对应的哈夫曼树编码。
    
- **特殊符号**：
    
    - `256`（END）：表示数据块结束。
        
    - `257~285`：代表 Length 范围（如 257=3, 258=4, ..., 285=258）。
        
    - Distance 通过额外比特扩展（如 Code=4 → 实际距离=5 + 1 比特扩展）。
        

---

### **3. 块存储与压缩模式**

DEFLATE 将数据分为多个 **块（Block）**，每个块可独立选择压缩模式：

1. **非压缩块（Stored）**
    
    - 直接存储原始数据（适用于已压缩或不可压缩数据）。
        
    - 结构：`[Header: 0][长度][反码长度][数据]`。
        
2. **静态哈夫曼块（Fixed Huffman）**
    
    - 使用预定义的哈夫曼树（无需存储树结构，适用于小数据）。
        
    - 编码效率较低，但解码速度快。
        
3. **动态哈夫曼块（Dynamic Huffman）**
    
    - 动态生成哈夫曼树，并存储树结构（适用于大数据）。
        
    - 结构：
        
        - 哈夫曼树描述（编码树本身用哈夫曼压缩！）。
            
        - 压缩后的数据。


| 分布类型               | 是否封闭性 | 是否有 p(xT∣x0)p(x_T | x_0)p(xT​∣x0​) 闭式表达 | 说明  |               |         |           |              |     |             |       |            |                                          |     |                   |       |               |                     |     |                  |       |                         |                 |     |                       |       |                  |            |     |                |      |                   |            |     |                |      |               |           |
| ------------------ | ----- | ----------------- | ------------------- | --- | ------------- | ------- | --------- | ------------ | --- | ----------- | ----- | ---------- | ---------------------------------------- | --- | ----------------- | ----- | ------------- | ------------------- | --- | ---------------- | ----- | ----------------------- | --------------- | --- | --------------------- | ----- | ---------------- | ---------- | --- | -------------- | ---- | ----------------- | ---------- | --- | -------------- | ---- | ------------- | --------- |
| **高斯分布（Gaussian）** | ✅ 是   | ✅ 有               | 最经典封闭族，均值和协方差可递推    |     | **多项式/二项式分布** | ✅（有限状态） | ✅（使用转移矩阵） | 状态有限，可用矩阵幂表示 |     | **指数族（部分）** | ✅ 有条件 | ✅ 某些条件下可推导 | 如 Dirichlet-Multinomial, Gamma-Poisson 等 |     | **Gamma 分布（正参数）** | ✅（加性） | ✅ 某些乘法或加法变换闭合 | 若乘上常数或加上独立 Gamma 变量 |     | **Dirichlet 分布** | ✅（共轭） | ✅ 与 Multinomial 结合有闭式更新 | 但注意本身不是马尔可夫过程结构 |     | **Wishart 分布（协方差矩阵）** | ✅（共轭） | ✅ 用于协方差建模的马尔可夫模型 | 在贝叶斯图模型中常见 |     | **泊松加法过程（特例）** | ✅ 特例 | ✅ 可积加 Poisson(Tλ) | 但非一般泊松转移封闭 |     | **贝塔分布（Beta）** | ✅ 共轭 | ✅ 与二项分布结合推导更新 | 常用于贝叶斯估计中 |